"0","# Define the model formula"
"0","foul_binomial_formula <- bf("
"0","  shots_made | trials(shots_taken) ~ "
"0","    1 + defender_foul_count + position + shot_distance_category +"
"0","    (1 + defender_foul_count | position)"
"0",")"
"0",""
"0","# Set priors"
"0","foul_priors <- c("
"0","  prior(normal(0, 0.5), class = ""b""),  # Fixed effects"
"0","  prior(normal(0, 0.5), class = ""sd""),  # Random effect standard deviations"
"0","  prior(lkj(2), class = ""cor"")  # Random effect correlations"
"0",")"
"0",""
"0","# Perform prior predictive checks"
"0","prior_check_model <- brm("
"0","  formula = foul_binomial_formula,"
"0","  data = synthetic_data_aggregated,"
"0","  family = binomial(link = ""logit""),"
"0","  prior = foul_priors,"
"0","  sample_prior = ""only"",  # Only sample from priors"
"0","  chains = 4,"
"0","  cores = 4,"
"0","  iter = 2000,"
"0","  warmup = 1000,"
"0","  seed = 42,"
"0","  backend = ""cmdstanr"""
"0",")"
"2","Compiling Stan program...
"
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1"," "
"2","Start sampling
"
"1","Running MCMC with 4 parallel chains...

"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  100 / 2000 [  5%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  300 / 2000 [ 15%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  500 / 2000 [ 25%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  700 / 2000 [ 35%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  900 / 2000 [ 45%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1100 / 2000 [ 55%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1300 / 2000 [ 65%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1500 / 2000 [ 75%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1700 / 2000 [ 85%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1900 / 2000 [ 95%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  100 / 2000 [  5%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  300 / 2000 [ 15%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  500 / 2000 [ 25%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  700 / 2000 [ 35%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  900 / 2000 [ 45%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1100 / 2000 [ 55%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1300 / 2000 [ 65%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1500 / 2000 [ 75%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1700 / 2000 [ 85%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1900 / 2000 [ 95%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  100 / 2000 [  5%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  300 / 2000 [ 15%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  500 / 2000 [ 25%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  700 / 2000 [ 35%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  900 / 2000 [ 45%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1100 / 2000 [ 55%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1300 / 2000 [ 65%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1500 / 2000 [ 75%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1700 / 2000 [ 85%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1900 / 2000 [ 95%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  100 / 2000 [  5%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  300 / 2000 [ 15%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  500 / 2000 [ 25%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  700 / 2000 [ 35%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  900 / 2000 [ 45%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1100 / 2000 [ 55%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1300 / 2000 [ 65%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1500 / 2000 [ 75%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1700 / 2000 [ 85%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1900 / 2000 [ 95%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","finished in"
"1"," "
"1","0.1"
"1"," "
"1","seconds.
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","finished in"
"1"," "
"1","0.1"
"1"," "
"1","seconds.
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","finished in"
"1"," "
"1","0.1"
"1"," "
"1","seconds.
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","finished in"
"1"," "
"1","0.1"
"1"," "
"1","seconds.
"
"1","
All"
"1"," "
"1","4"
"1"," "
"1","chains finished successfully.
"
"1","Mean chain execution time:"
"1"," "
"1","0.1"
"1"," "
"1","seconds.
"
"1","Total execution time:"
"1"," "
"1","0.2"
"1"," "
"1","seconds.

"
"0","# Plot prior predictive distributions"
"0","prior_predictions <- posterior_predict(prior_check_model)"
"0","prior_means <- colMeans(prior_predictions)"
"0",""
"0","# Create a data frame for plotting"
"0","prior_plot_data <- data.frame("
"0","  observed = synthetic_data_aggregated$shots_made,"
"0","  predicted = prior_means,"
"0","  position = synthetic_data_aggregated$position"
"0",")"
"0",""
"0","# Plot prior predictions vs observed"
"0","ggplot(prior_plot_data, aes(x = observed, y = predicted, color = position)) +"
"0","  geom_point(alpha = 0.6) +"
"0","  geom_abline(intercept = 0, slope = 1, linetype = ""dashed"") +"
"0","  labs(title = ""Prior Predictive Check"","
"0","       x = ""Observed Shots Made"","
"0","       y = ""Predicted Shots Made"") +"
"0","  theme_minimal()"
