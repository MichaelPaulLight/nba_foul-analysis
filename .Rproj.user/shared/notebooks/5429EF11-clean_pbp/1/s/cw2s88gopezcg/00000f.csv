"0","data_dir <- here::here(""02_data"", ""02-1_data_raw"")"
"0","file_pattern <- ""\\d+_pbp_gt\\.parquet$"""
"0",""
"0","files <- list.files(data_dir, pattern = file_pattern, full.names = TRUE)"
"0","latest_file <- files[order(file.mtime(files), decreasing = TRUE)][1]"
"0",""
"0",""
"0","pbp_df <- latest_file |> "
"0","  mutate(fouling_player = case_when("
"0","    str_detect(description, regex(""foul:"", ignore_case = T)) ~ player1, "
"0","    .default = NA"
"0","  )) |> "
"0","  mutate(fouled_player = case_when("
"0","    str_detect(description, regex(""foul:"", ignore_case = T)) ~ player3, "
"0","    .default = NA"
"0","  )) |> "
"0","  mutate(personal_fouls_after_event = case_when("
"0","    !is.na(fouling_player) ~ str_extract(description, regex(""\\([^()]*\\)(?![^()]*\\))""))"
"0","  )) |> "
"0","  mutate(personal_fouls_after_event = str_extract(personal_fouls_after_event, regex(""\\d+"")))"
"2","Error in UseMethod(""mutate"") : 
  no applicable method for 'mutate' applied to an object of class ""character""
"
